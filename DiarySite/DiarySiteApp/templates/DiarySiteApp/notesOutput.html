{% extends 'DiarySiteApp/base.html' %}

{% block title %}{{title}}{% endblock %}

{% block content %}
    {% if request.user.is_authenticated %}
        <header>
            <div class="header_content">
                <a href="{% url 'noteform' 'add' %}" class="control_button">Добавить заметку</a>
                <button class="burger_menu_button"></button>
            </div>
        </header>
        <div class="menu">
            <div class="profile">
                {% if user.socialaccount_set.all.0.get_avatar_url %}
                        <img class="avatar" src='{{ user.socialaccount_set.all.0.get_avatar_url }}'>
                {% else %}
                        {%if photo %}
                                <div>{{photo}}</div>
                        {%else%}
                                <img class="avatar" src='https://iupac.org/wp-content/uploads/2018/05/default-avatar.png'>
                        {% endif %}
                {% endif %}
                <a href="accounts/logout" title="Нажмите, чтобы выйти из аккаунта">
                    <div class="personal_information">
                            {% if user.first_name %}
                                <p>{{user.first_name}}</p> 
                                <p>{{user.last_name}}</p>
                            {% else %}
                                <p>{{user}}</p>
                            {% endif %}
                    </div>
                </a>
                <button class="burger_menu_close_button"></button>
            </div>

            <div class="tags_container">
                <a href="{% url 'main' %}"><div class="tag_button">Все заметки</div></a>
                <a href="{% url 'trashCan' %}"><div class="tag_button">Корзина</div></a>
                {% for tag in tags%}
                    <div class="custom_tag_button">
                        <a href="{% url 'notesByTag' tag.id %}"><div>{{tag.title}}</div></a>
                        <a href="{% url 'deleteTag' tag.id %}" class="delete_tag_button"></a>
                    </div>
                {% endfor %}
                <form method="POST" class="add_tag_form" action="addTag">
                    {% csrf_token %}
                    <input type="text" name="tag_title_input" autocomplete="off" class="input tag_title_input" placeholder="Добавить тег" required>
                    <button type="submit" class="save_tag_button"></button>
                </form>
            </div>
        </div>
        
        {% block notes %}{% endblock %}

    {% endif %}

    <script type="text/javascript">
        const openButton = document.querySelector('.burger_menu_button')
        const closeButton = document.querySelector('.burger_menu_close_button')
        const menu = document.querySelector('.menu')

        openButton.addEventListener("click", function(e){
            openButton.classList.toggle('_active');
            menu.classList.toggle('_active');
            document.body.classList.toggle('_lock');
        })

        closeButton.addEventListener("click", function(e){
            openButton.classList.toggle('_active');
            menu.classList.toggle('_active');
            document.body.classList.toggle('_lock');
        }) 
    </script>

{% endblock %}
