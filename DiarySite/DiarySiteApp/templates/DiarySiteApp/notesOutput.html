{% extends 'DiarySiteApp/base.html' %}

{% block title %}{{title}}{% endblock %}

{% block content %}
    {% if request.user.is_authenticated %}
        <header>
            <div class="header_content class">
                <a href="{% url 'noteform' 'add' %}" class="control_button">Добавить заметку</a>
                <button class="burger_menu_button">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                        width="24" height="24"
                        viewBox="0 0 172 172"
                        style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M21.5,35.83333c-2.58456,-0.03655 -4.98858,1.32136 -6.29153,3.55376c-1.30295,2.2324 -1.30295,4.99342 0,7.22582c1.30295,2.2324 3.70697,3.59031 6.29153,3.55376h129c2.58456,0.03655 4.98858,-1.32136 6.29153,-3.55376c1.30295,-2.2324 1.30295,-4.99342 0,-7.22582c-1.30295,-2.2324 -3.70697,-3.59031 -6.29153,-3.55376zM21.5,78.83333c-2.58456,-0.03655 -4.98858,1.32136 -6.29153,3.55376c-1.30295,2.2324 -1.30295,4.99342 0,7.22582c1.30295,2.2324 3.70697,3.59031 6.29153,3.55376h129c2.58456,0.03655 4.98858,-1.32136 6.29153,-3.55376c1.30295,-2.2324 1.30295,-4.99342 0,-7.22582c-1.30295,-2.2324 -3.70697,-3.59031 -6.29153,-3.55376zM21.5,121.83333c-2.58456,-0.03655 -4.98858,1.32136 -6.29153,3.55376c-1.30295,2.2324 -1.30295,4.99342 0,7.22582c1.30295,2.2324 3.70697,3.59031 6.29153,3.55376h129c2.58456,0.03655 4.98858,-1.32136 6.29153,-3.55376c1.30295,-2.2324 1.30295,-4.99342 0,-7.22582c-1.30295,-2.2324 -3.70697,-3.59031 -6.29153,-3.55376z"></path></g></g></svg>    
                </button>
            </div>
        </header>
        <div class="menu">
            <div class="profile">
                {% if user.socialaccount_set.all.0.get_avatar_url %}
                        <img class="avatar" src='{{ user.socialaccount_set.all.0.get_avatar_url }}'>
                {% else %}
                        {%if photo %}
                                <div>{{photo}}</div>
                        {%else%}
                                <img class="avatar" src='https://iupac.org/wp-content/uploads/2018/05/default-avatar.png'>
                        {% endif %}
                {% endif %}
                <a href="accounts/logout" title="Нажмите, чтобы выйти из аккаунта">
                    <div class="personal_information">
                            {% if user.first_name %}
                                <p>{{user.first_name}}</p> 
                                <p>{{user.last_name}}</p>
                            {% else %}
                                <p>{{user}}</p>
                            {% endif %}
                    </div>
                </a>
                <button class="burger_menu_close_button">
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                        width="45" height="45"
                        viewBox="0 0 172 172"
                        style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none"></path><g fill="#ffffff"><path d="M86,21.5c-35.55872,0 -64.5,28.9413 -64.5,64.5c0,35.55869 28.94128,64.5 64.5,64.5c35.55872,0 64.5,-28.94131 64.5,-64.5c0,-35.5587 -28.94128,-64.5 -64.5,-64.5zM86,32.25c29.749,0 53.75,24.00103 53.75,53.75c0,29.74897 -24.001,53.75 -53.75,53.75c-29.749,0 -53.75,-24.00103 -53.75,-53.75c0,-29.74897 24.001,-53.75 53.75,-53.75zM68.30029,60.69971l-7.60058,7.60058l17.69971,17.69971l-17.69971,17.69971l7.60058,7.60058l17.69971,-17.69971l17.69971,17.69971l7.60058,-7.60058l-17.69971,-17.69971l17.69971,-17.69971l-7.60058,-7.60058l-17.69971,17.69971z"></path></g></g></svg>
                </button>
            </div>

            <div class="tags_container">
                <a href="{% url 'main' %}"><div class="tag_button">Все заметки</div></a>
                <a href="{% url 'trashCan' %}"><div class="tag_button">Корзина</div></a>
                {% for tag in tags%}
                    <div class="custom_tag_button">
                        <a href="{% url 'notesByTag' tag.id %}"><div>{{tag.title}}</div></a>
                        <a href="{% url 'deleteTag' tag.id %}" class="delete_tag_button"></a>
                    </div>
                {% endfor %}
                <form method="POST" class="add_tag_form" action="addTag">
                    {% csrf_token %}
                    <input type="text" name="tag_title_input" autocomplete="off" class="input tag_title_input" placeholder="Добавить тег" required>
                    <button type="submit" class="save_tag_button"></button>
                </form>
            </div>
        </div>
        
        {% block notes %}{% endblock %}

    {% endif %}

    <script type="text/javascript">
        const openButton = document.querySelector('.burger_menu_button')
        const closeButton = document.querySelector('.burger_menu_close_button')
        const menu = document.querySelector('.menu')

        openButton.addEventListener("click", function(e){
            openButton.classList.toggle('_active');
            menu.classList.toggle('_active');
            document.body.classList.toggle('_lock');
        })

        closeButton.addEventListener("click", function(e){
            openButton.classList.toggle('_active');
            menu.classList.toggle('_active');
            document.body.classList.toggle('_lock');
        }) 
    </script>

{% endblock %}
